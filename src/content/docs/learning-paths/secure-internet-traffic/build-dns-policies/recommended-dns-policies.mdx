---
title: Recommended DNS policies
pcx_content_type: learning-unit
sidebar:
  order: 3

---

import { Details, Render, Tabs, TabItem } from "~/components"

We recommend you add the following DNS policies to build an Internet and SaaS app security strategy for your organization.


<Details header="All-DNS-Domain-Allowlist">
<Tabs syncKey="dashPlusAPI">
Allowlist any known domains and hostnames. With this policy, you ensure that your users can access your organization's domains even if the domains fall under a blocked category, such as **Newly Seen Domains** or **Login Screens**.
<TabItem label="Dashboard">
| Selector | Operator | Value           | Logic | Action |
| -------- | -------- | --------------- | ----- | ------ |
| Domain   | in list  | *Known Domains* | Or    | Allow  |
| Host     | in list  | *Known Domains* |       |        |
</TabItem>
<TabItem label="API">
```sh
curl --request POST \
  --url https://api.cloudflare.com/client/v4/accounts/{account_id}/gateway/rules \
  --header 'Content-Type: application/json' \
  --header "Authorization: Bearer <API TOKEN>" \
	--data '{
  "name": "All-DNS-Domain-Allowlist",
  "description": "Organization-wide whitelist. Explicitly allow resolution of these DNS domains",
  "precedence": 0,
  "enabled": false,
  "action": "allow",
  "filters": [
    "dns"
  ],
  "traffic": "any(dns.domains[*] in $<Global Whitelist UUID>) or dns.fqdn in $<Global Whitelist UUID>"
}'
```
</TabItem>
<TabItem label="Terraform">
```tf
resource "cloudflare_zero_trust_gateway_policy" "dns_whitelist_policy" {
  account_id  = var.account_id
  name        = "All-DNS-Domain-Allowlist"
  description = "Organization-wide whitelist. Explicitly allow resolution of these DNS domains"
  precedence  = 0
  enabled     = false
  action      = "allow"
  filters     = ["dns"]
  traffic     = "any(dns.domains[*] in ${"$"}${cloudflare_zero_trust_list.domain_whitelist.id}) or dns.fqdn in ${"$"}${cloudflare_zero_trust_list.domain_whitelist.id}"
}
```
</TabItem>
</Tabs>
</Details>


<Details header="Quarantined-Users-DNS-Restricted-Access">

<Render file="zero-trust/blocklist-restricted-users" />
<Tabs>
<TabItem label="Dashboard">
| Selector         | Operator			| Value															| Logic | Action |
| ---------------- | ------------ | --------------------------------- | ----- | ------ |
| Domain           | not in list  | *Allowed Remediation Domains*     | Or    | Block  |
| Host             | not in list  | *Allowed Remediation Domains*     | And   |        |
| User Group Names | in						| *Quarantined Users*								|       |        |
</TabItem>
<TabItem label="API">
```sh
curl --request POST \
  --url https://api.cloudflare.com/client/v4/accounts/{account_id}/gateway/rules \
  --header 'Content-Type: application/json' \
  --header "Authorization: Bearer <API TOKEN>" \
	--data '{
  "name": "Quarantined-Users-DNS-Restricted-Access",
  "description": "Restrict quarantined users traffic to corporate policy remediation domains, so that quarantined users can obtain help and/or remediate their security posture",
  "precedence": 10,
  "enabled": false,
  "action": "block",
  "filters": [
    "dns"
  ],
	"traffic": "not(any(dns.domains[*] in $<Allowed Remediation Domains list UUID>)) or not(any(dns.domains[*] in $<Allowed Remediation Domains list UUID>))",
  "identity": "any(identity.groups.name[*] in {\"Quarantined Users\"})",
	"rule_settings": {
    "block_page_enabled": true,
    "notification_settings": {
      "enabled": true
    }
	}'
```
</TabItem>
<TabItem label="Terraform">
```tf
resource "cloudflare_zero_trust_gateway_policy" "dns_restrict_quarantined_users" {
  account_id  = var.account_id
  name        = "Quarantined-Users-DNS-Restricted-Access"
  description = "Restrict quarantined users traffic to corporate policy remediation domains, so that quarantined users can obtain help and/or remediate their security posture"
  precedence  = 10
  enabled     = false
  action      = "block"
  filters     = ["dns"]
  traffic     = "not(any(dns.domains[*] in ${"$"}${cloudflare_zero_trust_list.allowed_remediation_domains.id})) or not(any(dns.domains[*] in ${"$"}${cloudflare_zero_trust_list.allowed_remediation_domains.id}))"
	identity		=	"any(identity.groups.name[*] in {\"Quarantined Users\"})"
	rule_settings {
			block_page_enabled = true
			notification_settings {
					enabled = true
				}
		}
}
```
</TabItem>
</Tabs>

</Details>


<Details header="All-DNS-SecurityCategories-Blocklist">

<Render file="zero-trust/blocklist-security-categories" />

<Render file="gateway/policies/block-security-categories" product="cloudflare-one" />


</Details>


<Details header="All-DNS-ContentCategories-Blocklist">

<Render file="zero-trust/blocklist-content-categories" params={{ one: "DNS", two: "Security Risks" }} />


</Details>


<Details header="All-DNS-Application-Blocklist">

<Render file="zero-trust/blocklist-application" />


</Details>


<Details header="All-DNS-GeoCountryIP-Blocklist">
Block websites hosted in countries categorized as high risk. The designation of such countries may result from your organization's users or through the implementation of regulations including [EAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries), [OFAC](https://orpa.princeton.edu/export-controls/sanctioned-countries), and [ITAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries).
<Tabs>
<TabItem label="Dashboard">
| Selector                        | Operator | Value                                                                                                                                                           | Action |
| ------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| Resolved Country IP Geolocation | in       | *Afghanistan*, *Belarus*, *Congo (Kinshasa)*, *Cuba*, *Iran*, *Iraq*, *Korea (North)*, *Myanmar*, *Russian Federation*, *Sudan*, *Syria*, *Ukraine*, *Zimbabwe* | Block  |
</TabItem>
<TabItem label="API">
```sh
curl --request POST \
  --url https://api.cloudflare.com/client/v4/accounts/{account_id}/gateway/rules \
  --header 'Content-Type: application/json' \
  --header "Authorization: Bearer <API TOKEN>" \
	--data '{
	"name": "All-DNS-GeoCountryIP-Blocklist",
  "description": "Block traffic hosted in countries categorized as high security risks",
  "precedence": 50,
  "enabled": false,
  "action": "block",
  "filters": [
    "dns"
  ],
  "traffic": "any(dns.dst.geo.country[*] in {\"AF\" \"BY\" \"CD\" \"CU\" \"IR\" \"IQ\" \"KP\" \"MM\" \"RU\" \"SD\" \"SY\" \"UA\" \"ZW\"})",
  "rule_settings": {
    "block_page_enabled": true,
    "block_reason": "This domain was blocked due to being classified as a security risk to the organisation"
    }
}'
```
</TabItem>
<TabItem label="Terraform">
```tf
resource "cloudflare_zero_trust_gateway_policy" "dns_geolocation_block_policy" {
  account_id  = var.account_id
  name        = "All-DNS-GeoCountryIP-Blocklist"
  description = "Block traffic hosted in countries categorized as high security risks"
  precedence  = 50
  enabled     = false
  action      = "block"
  filters     = ["dns"]
  traffic     = "any(dns.dst.geo.country[*] in {\"AF\" \"BY\" \"CD\" \"CU\" \"IR\" \"IQ\" \"KP\" \"MM\" \"RU\" \"SD\" \"SY\" \"UA\" \"ZW\"})"
  rule_settings {
      block_page_enabled = true
      block_page_reason = "This domain was blocked due to being classified as a security risk to the organisation"
    }
}
```
</TabItem>
</Tabs>

</Details>


<Details header="All-DNS-DomainTopLevel-Blocklist">
Block frequently misused top-level domains (TLDs) to reduce security risks, especially when there is no discernible advantage to be gained from allowing access. Similarly, restricting access to specific country-level TLDs may be necessary to comply with regulations such as [OFAC](https://orpa.princeton.edu/export-controls/sanctioned-countries) and [ITAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries).
<Tabs>
<TabItem label="Dashboard">
| Selector | Operator      | Value                                                                                                    | Action |
| -------- | ------------- | -------------------------------------------------------------------------------------------------------- | ------ |
| Domain   | matches regex | `[.](cn\|ru)$ or [.](rest\|hair\|top\|live\|cfd\|boats\|beauty\|mom\|skin\|okinawa)$ or [.](zip\|mobi)$` | Block  |
</TabItem>
<TabItem label="API">
```sh
curl --request POST \
  --url https://api.cloudflare.com/client/v4/accounts/{account_id}/gateway/rules \
  --header 'Content-Type: application/json' \
  --header "Authorization: Bearer <API TOKEN>" \
	--data '{
  "name": "All-DNS-DomainTopLevel-Blocklist",
  "description": "Block DNS queries of known risky TLDs",
  "precedence": 60,
  "enabled": false,
  "action": "block",
  "filters": [
    "dns"
  ],
  "traffic": "any(dns.domains[*] matches \"[.](cn|ru)$ or [.](rest|hair|top|live|cfd|boats|beauty|mom|skin|okinawa)$ or [.](zip|mobi)$\")",
  "rule_settings": {
    "block_page_enabled": true,
    "block_reason": "This domain was blocked due to being classified as a security risk to the organisation"
    }
  }'
```
</TabItem>
<TabItem label="Terraform">
```tf
resource "cloudflare_zero_trust_gateway_policy" "dns_blacklist_policy" {
  account_id  = var.account_id
  name        = "All-DNS-DomainTopLevel-Blocklist"
  description = "Block DNS queries of known risky TLDs"
  precedence  = 60
  enabled     = false
  action      = "block"
  filters     = ["dns"]
  traffic     = "any(dns.domains[*] matches \"[.](cn|ru)$ or [.](rest|hair|top|live|cfd|boats|beauty|mom|skin|okinawa)$ or [.](zip|mobi)$\")"
  rule_settings {
      block_page_enabled = true
      block_page_reason = "This domain was blocked due to being classified as a security risk to the organisation"
    }
}
```
</TabItem>
</Tabs>

</Details>


<Details header="All-DNS-DomainPhishing-Blocklist">

Block misused domains to protect your users against sophisticated phishing attacks, such as domains that specifically target your organization. For example, the following policy blocks specific keywords associated with an organization or its authentication services (such as `okta`, `2fa`, `cloudflare` and `sso`) while still allowing access to known domains.
<Tabs>
<TabItem label="Dashboard">
| Selector | Operator      | Value                                       | Logic | Action |
| -------- | ------------- | ------------------------------------------- | ----- | ------ |
| Domain   | not in list   | *Known Domains*                             | And   | Block  |
| Domain   | matches regex | `.*okta.*\|.*cloudflare.*\|.*mfa.*\|.sso.*` |       |        |
</TabItem>
<TabItem label="API">
```sh
curl --request POST \
  --url https://api.cloudflare.com/client/v4/accounts/{account_id}/gateway/rules \
  --header 'Content-Type: application/json' \
  --header "Authorization: Bearer <API TOKEN>" \
	--data '{
	"name": "All-DNS-DomainPhishing-Blocklist",
  "description": "Block misused domains used in phishing campaigns",
  "precedence": 70,
  "enabled": false,
  "action": "block",
  "filters": [
    "dns"
  ],
  "traffic": "any(dns.domains[*] matches \".*okta.*|.*cloudflare.*|.*mfa.*|.sso.*\") and not(any(dns.domains[*] in $<Known Phishing Domains List UUID>))",
  "rule_settings": {
    "block_page_enabled": true,
    "block_reason": "This domain was blocked due to being classified as a security risk to the organisation"
    }

		}'
```
</TabItem>
<TabItem label="Terraform">
```tf
resource "cloudflare_zero_trust_gateway_policy" "dns_phishing_domains_block" {
  account_id  = var.account_id
  name        = "All-DNS-DomainPhishing-Blocklist"
  description = "Block misused domains used in phishing campaigns"
  precedence  = 70
  enabled     = false
  action      = "block"
  filters     = ["dns"]
  traffic     = "any(dns.domains[*] matches \".*okta.*|.*cloudflare.*|.*mfa.*|.sso.*\") and not(any(dns.domains[*] in $<Known Phishing Domains List UUID>))"
  rule_settings {
      block_page_enabled = true
      block_page_reason = "This domain was blocked due to being classified as a security risk to the organisation"
    }
}
```
</TabItem>
</Tabs>

</Details>


<Details header="All-DNS-ResolvedIP-Blocklist">

Block specific IP addresses that are malicious or pose a threat to your organization.

<Render file="zero-trust/threat-intelligence-automation" />

| Selector    | Operator | Value          | Action |
| ----------- | -------- | -------------- | ------ |
| Resolved IP | in list  | *IP Blocklist* | Block  |


</Details>


<Details header="All-DNS-DomainHost-Blocklist">

<Render file="zero-trust/blocklist-domain-host" params={{ one: "DNS" }} />


</Details>