---
title: CLI quick start
pcx_content_type: get-started
updated: 2038-01-19
sidebar:
  order: 3

---

import { Render, PackageManagers } from "~/components"

:::note

Workflows is in **public beta**, and any developer with a [free or paid Workers plan](/workers/platform/pricing/#workers) can start using Workflows immediately.

To learn more about Workflows, read [the beta announcement blog](https://blog.cloudflare.com/THE-BLOG-SLUG-WILL-GO-HERE) and the [How Workflows Works](/workflows/build/how-workflows-works/) developer documentation.

:::

Workflows allow you to build durable, multi-step applications using the Workers platform. A Workflow can automatically retry, persist state, run for hours or days, and coordinate between third-party APIs.

You can build Workflows to post-process file uploads to [R2 object storage](/r2/), automate generation of [Workers AI](/workers-ai/) embeddings into a [Vectorize](/vectorize/) vector database, or to trigger [user lifecycle emails](TODO) using your favorite email API.

## Prerequisites

:::caution

This guide is for users who are already familiar with Cloudflare Workers and [durable execution](/workflows/reference/how-workflows-works/) programming models.

If you're new to either, we recommend the [introduction to Workflows](/workflows/get-started/guide/) guide, which steps through how a Workflow is defined, how to persist state, and how to deploy and run your first Workflow.

:::

Before you continue, ensure you:

1. Sign up for a [Cloudflare account](https://dash.cloudflare.com/sign-up/workers-and-pages) if you have not already.
2. Install [`npm`](https://docs.npmjs.com/getting-started).
3. Install [`Node.js`](https://nodejs.org/en/). Use a Node version manager like [Volta](https://volta.sh/) or [nvm](https://github.com/nvm-sh/nvm) to avoid permission issues and change Node.js versions. [Wrangler](/workers/wrangler/install-and-update/) requires a Node version of `16.17.0` or later.

## 1. Create a Workflow

Workflows are defined as part of a Worker script.

To create a Workflow, use the `create cloudflare` (C3) CLI tool, specifying the Workflows starter template:

```sh
npm create cloudflare@latest workflows-starter -- --template "cloudflare/workflows-starter"
```

This will create a new folder called `workflows-tutorial`, which contains two files:

* `src/index.ts` - this is where your Worker script, including your Workflows definition, is defined.
* `wrangler.toml` - the configuration for your Workers project and your Workflow.

Open the `src/index.ts` file in your text editor. This file contains the following code, which is the most basic instance of a Workflow definition:

```ts title="src/index.ts"
// Import the Workflow definition
import { WorkflowEntrypoint, WorkflowEvent, WorkflowStep } from "cloudflare:workflows"

// Create your own class that implements a Workflow
export class MyWorkflow implements WorkflowEntrypoint {
    // Define a run() method
    async run(event: WorkflowEvent, step: WorkflowStep) {
        // Define one or more steps that optionally return state.
      	const state = await step.do('my first step', async () => {
            return {}
		});

		await step.sleep('wait on something', '1 minute');

		await step.do(
			'make a call to write that could maybe, just might, fail',
			async () => {
				// Do stuff here, with access to 'state' from the previous step
				if (Math.random() > 0.5) {
					throw new Error('API call to $STORAGE_SYSTEM failed');
				}
			}
		);
    }
}
```

Specifically:

1. TODO - describe the Workflow class
2. TODO - how params are injected
3. TODO - how state is persisted
4. TODO - retries and config
5. TODO - triggering from a fetch handler

```ts title="src/index.ts"


```

## 2. Deploy a Workflow

Workflows are deployed via [`wrangler](/workers/wrangler/install-and-update/), which is installed when you first ran `npm create cloudflare`, above. Workflows are Workers scripts, and deployed the same way.

```sh
npx wrangler@latest deploy
```
```sh output
TODO
```

## 3. Running a Workflow

TODO - basic trigger steps

### CLI

```sh
# Trigger a Workflow from the CLI, and pass (optional) parameters as an event to the Workflow.
npx wrangler@latest workflows trigger workflows-tutorial --params={"hello":"world"}
```

Refer to the [events and parameters documentation](/workflows/build/events-and-parameters/) to understand how events are passed to Workflows.

### Worker binding

TODO - trigger from a Worker

```toml title="wrangler.toml"
[[workflows]]
# name of your workflow
name = "workflows-starter"
# binding name env.MYWORKFLOW
binding = "MY_WORKFLOW"
# this is class that extends the Workflow class in src/index.ts
class_name = "MyWorkflow"
# script_name is required during for the beta.
# Must match the "name" of your Worker at the top of wrangler.toml
script_name = "workflows-starter"
```

You can then invoke the methods on this binding directly from your Worker script. The `Workflow` type has methods for:

* `create(newId, params)` - creating (triggering) a new instance of the Workflow, with optional
* `get(id)`- retrieve a Workflow instance by ID
* `status()` - get the current status of a unique Workflow instance.

For example, the following Worker will fetch the status of an existing Workflow instance by ID (if supplied), else it will create a new Workflow instance and return its ID:

```ts title="src/index.ts"
// Import the Workflow definition
import { WorkflowEntrypoint, WorkflowEvent, WorkflowStep } from "cloudflare:workflows"

interface Env {
  // Matches the binding definition in your wrangler.toml
  MY_WORKFLOW: Workflow;
}

export default {
	async fetch(req: Request, env: Env) {
        //
        const instanceId = new URL(req.url).searchParams.get("instanceId")

        // If an ?instanceId=<id> query parameter is provided, fetch the status
        // of an existing Workflow by its ID.
        if (instanceId) {
            let instance = await env.MYWORKFLOW.get(id);
			return Response.json({
				status: await instance.status(),
			});
        }

        // Else, create a new instance of our Workflow, passing in any (optional) params
        // and return the ID.
		const newId = await crypto.randomUUID();
		let instance = await env.MYWORKFLOW.create(newId, {});
		return Response.json({
			id: instance.id,
			details: await instance.status(),
		});

		return Response.json({ result });
	},
};
```

Refer to the [triggering Workflows] documentation for how to trigger a Workflow from other Workers handler functions.

## 4. Managing Workflows

TODO - managing via the CLI

* Listing
* Showing running instances
* Inspecting an instances state

## Next steps

* TODO
* ALSO TODO
* ALSO ALSO TODO

If you have any feature requests or notice any bugs, share your feedback directly with the Cloudflare team by joining the [Cloudflare Developers community on Discord](https://discord.cloudflare.com).
